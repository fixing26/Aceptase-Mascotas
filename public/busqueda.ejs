<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Aceptase Mascotas! - Busqueda</title>
  <link rel="stylesheet" href="/css/global.css">
  <link rel="stylesheet" href="/css/menu.css">
  <link rel="stylesheet" href="/css/paginaBusqueda.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" />
  <link rel="shortcut icon" type="image" href="/img/icon-pet-paw.svg">
</head>
<body>
  <div class="container">
    <div class="back">
      <header class="header">
        <a href="index.html" class="title">Aceptase Mascotas</a>
        <nav>
          <ul class="navs">
            <li id="Anuncie" class="options border_options"><a href="nuevoanuncio.html">Anuncie aqui</a></li>
            <li id="Mis anuncios" class="options border_options"><a href="misanuncios.html">Mis anuncios</a></li>
            <li id="Favoritos" class="options border_options"><a href="">Favoritos</a></li>
            <li id="logout-btn" class="options border_options"><a href="#" onclick="logout()">Cerrar sesión</a></li>
            <li id="login-btn" class="options login" style="display: inline-block;"><a href="login.html">ENTRAR</a></li>
          </ul>
        </nav>
      </header>
      <div class="total">
        <div class="filter_container">
          <h3>Precio</h3>
          <div class="minmaxHeader">
            <p>mínimo</p>
            <p>máximo</p>
          </div>
          <form class="minmax" action="">
            <input class="input" type="number" min="0" placeholder="0€">
            <input class="input" type="number" min="0" placeholder="0€">
          </form>
          <h3>Tipo de vivienda</h3>
          <form action="">
            <label><input class="ckbox" type="checkbox">Pisos, apartamentos</label>
            <br>
            <label><input class="ckbox" type="checkbox">Casas y chalets</label>
          </form>
          <h3>Habitaciones</h3>
          <form action="">
            <label><input class="ckbox" type="checkbox">1</label>
            <br>
            <label><input class="ckbox" type="checkbox">2</label>
            <br>
            <label><input class="ckbox" type="checkbox">3+</label>
          </form>
          <h3>Baños</h3>
          <form action="">
            <label><input class="ckbox" type="checkbox">1</label>
            <br>
            <label><input class="ckbox" type="checkbox">2</label>
            <br>
            <label><input class="ckbox" type="checkbox">3+</label>
          </form>
          <h3>Area del Imóvel</h3>
          <div class="minmaxHeader">
            <p>mínimo</p>
            <p>máximo</p>
          </div>
          <form class="minmax" action="">
            <input class="input" type="number" min="0" placeholder="m²">
            <input class="input" type="number" min="0" placeholder="m²">
          </form>
          <div class="container_btn">
            <button class="btn">BUSCAR</button>
          </div>
        </div>
        <div class="Resultado">
          <% if (Resultado.length > 0) { %>
            <h2><%= Resultado[0].Ciudad %></h2>
          <% } %>
          <% Resultado.forEach(function(anuncio) { %>
            <div class="info">
              <section class="container_slidephotos">
                <ul class="photos">
                  <% anuncio.files.forEach(function(file) { %>
                    <li class="photo" photo-active><img src="/uploads/<%= file.filename %>" alt="<%= file.originalname %>"></li>
                  <% }); %>
                </ul>
                <button class="previous_btn" photo-change-slide-button="previous">&lt;</button>
                <button class="next_btn" photo-change-slide-button="next">&gt;</button>
              </section>
              <div class="description">
                <h3 class="price"><%= anuncio.Precio %>€/mes</h3>
                <h3 class="size"><span class="material-symbols-outlined input_svg">resize</span><%= anuncio.Area %>m²</h3>
                <p class="zona"><%= anuncio.Descripcion %></p>
                <span class="material-symbols-outlined input_svg position_bed">bed</span>
                <p class="beds"><%= anuncio.NumeroHab %> habitaciones</p>
                <span class="material-symbols-outlined input_svg position_bathroom">shower</span>
                <p class="bathrooms"><%= anuncio.NumeroBan %> baños</p>
                <span class="fav" id="favo">
                  <span id="fav" class="positionbtnfav material-symbols-outlined input_svg dislike">heart_plus</span>
                </span>
              </div>
            </div>
          <% }); %>
        </div>
      </div>
    </div>
  </div>
  <footer class="container_footer">
    <p>© copyright 2024 - Aceptase Mascotas!</p>
  </footer>
</body>
</html>


	<script>
		// función para cambiar las fotos.
		const changePhotoButtons = document.querySelectorAll("[photo-change-slide-button]");
		changePhotoButtons.forEach(button => {
			button.addEventListener("click", () => {
				/*console.log("entra")*/
				const photos = document.querySelector(".photos");
				const activePhoto = photos.querySelector("[photo-active]");
				const indexActivePhoto = Array.from(photos.children).indexOf(activePhoto);
				let indexNewActivePhoto;

				if (button.dataset.changeSlideButton === "next") {
					indexNewActivePhoto = indexActivePhoto + 1;
				} else {
					indexNewActivePhoto = indexActivePhoto - 1;
				}
				if (indexNewActivePhoto >= photos.children.length) {
					indexNewActivePhoto = 0;
				}
				if (indexNewActivePhoto < 0) {
					indexNewActivePhoto = photos.children.length - 1;
				}
				activePhoto.removeAttribute("photo-active");
				photos.children[indexNewActivePhoto].setAttribute("photo-active", true);
			});
		});
	
		document.addEventListener('DOMContentLoaded', function() {
			const token = localStorage.getItem('token');
			console.log('Token',token);
			if (token) {
				// Si hay un token en el almacenamiento local, el usuario está logeado
				document.getElementById('logout-btn').style.display = 'inline-block'; // Mostrar el botón de cerrar sesión
				document.getElementById('login-btn').style.display = 'none'; // Ocultar el botón de inicio de sesión
				document.getElementById('Anuncie').style.display = 'inline-block';
				document.getElementById('Mis anuncios').style.display = 'inline-block';
				document.getElementById('Favoritos').style.display = 'inline-block';
				document.getElementById("favo").style.display = 'inline-block';
			} else {
				// Si no hay token en el almacenamiento local, el usuario no está logeado
				document.getElementById('logout-btn').style.display = 'none'; // Ocultar el botón de cerrar sesión
				document.getElementById('login-btn').style.display = 'inline-block'; // Mostrar el botón de inicio de sesión
				document.getElementById('Anuncie').style.display = 'none';
				document.getElementById('Mis anuncios').style.display = 'none';
				document.getElementById('Favoritos').style.display = 'none';
				document.getElementById("favo").style.display = 'none';
			}
		});
	
		function logout() {
			// Eliminar la información del usuario del almacenamiento local
			localStorage.removeItem('token');
			// Redirigir al usuario a la página de inicio de sesión
			window.location.href = 'login.html';
		}
			// función para añadir like y quitar like de un anuncio
		const fav = document.getElementById("fav");
		fav.addEventListener("click", function() {
			if (fav.classList.contains("like")) {
				fav.classList.remove("like");
			} else {
				fav.classList.add("like");
			}
		});


	</script>
  </body>

</html>